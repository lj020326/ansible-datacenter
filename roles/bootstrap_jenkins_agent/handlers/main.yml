---
# handlers file for jenkins-agent
- name: Reload Systemd
  when: ansible_facts['service_mgr'] == "systemd"
  become: true
  ansible.builtin.systemd:
    daemon_reload: true
    name: "{{ jenkins_agent__service_name }}"
    enabled: true
    state: started

- name: Restart Jenkins Agent service
  become: true
  ansible.builtin.service:
    name: "{{ jenkins_agent__service_name }}"
    enabled: true
    state: restarted

- name: Install Jenkins as a service
  ansible.windows.win_shell: "{{ jenkins_agent__win_jenkins_agent_wrapper_path }} install"
  notify: Start the Jenkins service

- name: Start the Jenkins service
  ansible.windows.win_service:
    name: "{{ jenkins_agent__task_name }}"
    start_mode: auto
    state: started

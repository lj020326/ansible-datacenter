---

#__docker_stack__ansibletemplateui__image_default: "sivel/ansible-template-ui:devel"
__docker_stack__ansibletemplateui__image_default: "{{ docker_stack__registry_endpoint }}/ansible-template-ui:latest"
__docker_stack__ansibletemplateui__image: "{{ docker_stack__ansibletemplateui__image 
  | d(__docker_stack__ansibletemplateui__image_default) }}"

__docker_stack__ansibletemplateui__http_port: "{{ docker_stack__ansibletemplateui_http_port | d('4081') }}"
__docker_stack__ansibletemplateui__traefik_labels: "{{ docker_stack__ansibletemplateui__traefik_labels 
  | d(__docker_stack__ansibletemplateui__traefik_labels_default) }}"

__docker_stack__ansibletemplateui__config_dirs:
  - { path: "{{ docker_stack__dir }}/ansible_template_ui" }

__docker_stack__ansibletemplateui__firewalld_ports:
  - "{{ docker_stack__ansibletemplateui_http_port }}/tcp"

#__docker_stack__ansibletemplateui__config_tpls:
#  - { src: "ansibletemplateui/ansibletemplateui.xml.j2", dest: "{{ docker_stack__dir }}/ansibletemplateui/conf/ansibletemplateui.xml" }

__docker_stack__ansibletemplateui__services:
  ## ref: https://github.com/lj020326/ansible-template-ui
  ansibletemplateui:
    image: "{{ __docker_stack__ansibletemplateui__image }}"
    user: "{{ docker_stack__user_uid }}:{{ docker_stack__user_gid }}"
    restart: "unless-stopped"
    networks:
      - "{{ docker_stack__traefik_proxy_network }}"
    volumes:
      - "{{ docker_stack__dir }}/ansibletemplateui:/data"
    ports:
      - "{{ __docker_stack__ansibletemplateui__http_port }}:8080"
    labels: "{{ __docker_stack__ansibletemplateui__traefik_labels }}"
    deploy:
      mode: replicated
      replicas: 1
      restart_policy:
        condition: on-failure
        delay: 10s
        max_attempts: 3
        window: 120s


docker_stack__appspec__ansibletemplateui:
  dirs: "{{ __docker_stack__ansibletemplateui__config_dirs | d([]) }}"
  files: "{{ __docker_stack__ansibletemplateui__config_files | d([]) }}"
  templates: "{{ __docker_stack__ansibletemplateui__config_tpls | d([]) }}"
  firewalld_services: "{{ __docker_stack__ansibletemplateui__firewalld_services | d([]) }}"
  firewalld_ports: "{{ __docker_stack__ansibletemplateui__firewalld_ports | d([]) }}"
  networks: "{{ __docker_stack__ansibletemplateui__networks | d({}) }}"
  docker_services: "{{ __docker_stack__ansibletemplateui__services | d({}) }}"


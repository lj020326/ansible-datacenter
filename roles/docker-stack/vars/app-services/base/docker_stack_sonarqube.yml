---

__docker_stack_appspecs__sonarqube_stack_dir: "{{ docker_stack_dir | d('/home/user/docker-dirs') }}"

__docker_stack_appspecs__sonarqube_http: "{{ docker_stack_sonarqube_http | d('10180') }}"

#__docker_stack_appspecs__sonarqube_image: "{{ docker_stack_registry_endpoint }}/sonarqube:latest"
__docker_stack_appspecs__sonarqube_image: "sonarqube:community"

__docker_stack_appspecs__sonarqube_db: sonar
__docker_stack_appspecs__sonarqube_db_user: test
__docker_stack_appspecs__sonarqube_db_password: test


#__docker_stack_appspecs__sonarqube_data_dir: /export/data/sonarqube/osimages
#__docker_stack_appspecs__sonarqube_data_dir: /export/data/sonarqube

docker_stack_appspec_config_dirs__sonarqube:
  - { path: "{{ __docker_stack_appspecs__sonarqube_stack_dir }}/sonarqube" }

#docker_stack_appspec_config_tpls__sonarqube:
#  - { src: 'sonarqube/config-group.conf.j2', dest: "{{ __docker_stack_appspecs__sonarqube_stack_dir }}/sonarqube/group" }
#  - { src: 'sonarqube/config-passwd.conf.j2', dest: "{{ __docker_stack_appspecs__sonarqube_stack_dir }}/sonarqube/passwd" }

docker_stack_firewalld_appspec_ports__sonarqube:
  - "{{ __docker_stack_appspecs__sonarqube_agent_tcp_port }}/tcp"


docker_stack_appspec_volumes__sonarqube:
  sonar_psql:
    driver: local
    driver_opts:
        type: none
        device: "$PWD/sonar_psql"
        o: bind

  sonar_psql_data:
    driver: local
    driver_opts:
        type: none
        device: "$PWD/sonar_psql_data"
        o: bind

  sonarqube_data:
    driver: local
    driver_opts:
        type: none
        device: "$PWD/sonarqube_data"
        o: bind

  sonarqube_extensions:
    driver: local
    driver_opts:
        type: none
        device: "$PWD/sonarqube_extensions"
        o: bind

  sonarqube_logs:
    driver: local
    driver_opts:
        type: none
        device: "$PWD/sonarqube_logs"
        o: bind


docker_stack_appspec__sonarqube:
  dirs: "{{ docker_stack_appspec_config_dirs__sonarqube | d([]) }}"
  files: "{{ docker_stack_appspec_config_files__sonarqube | d([]) }}"
  templates: "{{ docker_stack_appspec_config_tpls__sonarqube | d([]) }}"
  firewalld_services: "{{ docker_stack_firewalld_appspec_services__sonarqube | d([]) }}"
  firewalld_ports: "{{ docker_stack_firewalld_appspec_ports__sonarqube | d([]) }}"
  networks: "{{ docker_stack_appspec_networks__sonarqube | d({}) }}"
  volumes: "{{ docker_stack_appspec_volumes__sonarqube | d({}) }}"
  docker_services: "{{ docker_stack_appspec_services__sonarqube | d({}) }}"

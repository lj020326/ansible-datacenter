---

__docker_stack_appspecs__jenkins_jcac_stack_dir: "{{ docker_stack_dir | d('/home/user/docker-dirs') }}"
__docker_stack_appspecs__jenkins_jcac_base_dir: "{{ docker_stack_jenkins_jcac_dir | d(__docker_stack_appspecs__jenkins_jcac_stack_dir + '/jenkins') }}"

__docker_stack_appspecs__jenkins_jcac_http: "{{ docker_stack_jenkins_jcac_http | d('10180') }}"

## ref: https://www.jenkins.io/blog/2020/05/11/docker-windows-agents/
## ref: https://support.cloudbees.com/hc/en-us/articles/115001771692-How-to-Create-Permanent-Agents-with-Docker
## ref: https://github.com/jenkinsci/docker-inbound-agent
## ref: https://wiki.tds.tieto.com/display/TDSKB/Executing+Jenkins+jobs+when+only+one+way+network+connection+exists
__docker_stack_appspecs__jenkins_jcac_agent_port: "{{ docker_stack_jenkins_jcac_agent_port | d('9000') }}"
__docker_stack_appspecs__jenkins_jcac_agent_tcp_port: "{{ docker_stack_jenkins_jcac_tcp_port | d('9000') }}"
__docker_stack_appspecs__jenkins_jcac_agent_ssh_port: "{{ docker_stack_jenkins_jcac_ssh_port | d('4444') }}"

__docker_stack_appspecs__jenkins_jcac_mgr_pwd_secret: "{{ docker_stack_jenkins_jcac_mgr_pwd_secret | d('00000000000000000000000') }}"

## ref: https://www.jenkins.io/blog/2020/05/11/docker-windows-agents/
#__docker_stack_appspecs__jenkins_jcac_image: "jenkins/jenkins:lts"
__docker_stack_appspecs__jenkins_jcac_image: "{{ docker_stack_jenkins_jcac_image | d(docker_stack_registry_endpoint + '/jenkins-docker:latest') }}"

__docker_stack_appspecs__jenkins_jcac_ldap_host: "{{ docker_stack_jenkins_jcac_ldap_host | d('ldap.example.int:389')}}"
__docker_stack_appspecs__jenkins_jcac_ldap_base_dn: "{{ docker_stack_jenkins_jcac_ldap_base_dn | d('dc=example,dc=int')}}"

#__docker_stack_appspecs__jenkins_jcac_data_dir: /export/data/jenkins/osimages
#__docker_stack_appspecs__jenkins_jcac_data_dir: /export/data/jenkins
__docker_stack_appspecs__jenkins_jcac_data_dir: /data/datacenter/jenkins

__docker_stack_vmware_data_dir_default: /data/datacenter/vmware
__docker_stack_vmware_data_dir: "{{ docker_stack_vmware_data_dir | d(__docker_stack_vmware_data_dir_default) }}"

docker_stack_appspec_config_dirs__jenkins_jcac:
  - { path: "{{ __docker_stack_appspecs__jenkins_jcac_base_dir }}" }
  - { path: "{{ __docker_stack_appspecs__jenkins_jcac_base_dir }}/jenkins_home" }
  - { path: "{{ __docker_stack_appspecs__jenkins_jcac_data_dir }}" }
  - { path: "{{ __docker_stack_appspecs__jenkins_jcac_data_dir }}/osimages" }
#  - { path: "{{ __docker_stack_appspecs__jenkins_jcac_agent_base_dir }}" }
#  - { path: "{{ __docker_stack_appspecs__jenkins_jcac_agent_base_dir }}/jenkins_home" }
#  - { path: "{{ __docker_stack_appspecs__jenkins_jcac_swarm_base_dir }}" }
#  - { path: "{{ __docker_stack_appspecs__jenkins_jcac_swarm_base_dir }}/jenkins_home" }

docker_stack_appspec_config_tpls__jenkins_jcac:
  - { src: 'jenkins/config-group.conf.j2', dest: "{{ __docker_stack_appspecs__jenkins_jcac_base_dir }}/group" }
  - { src: 'jenkins/config-passwd.conf.j2', dest: "{{ __docker_stack_appspecs__jenkins_jcac_base_dir }}/passwd" }
#  - { src: 'jenkins/config-agent-group.conf.j2', dest: "{{ __docker_stack_appspecs__jenkins_jcac_agent_base_dir }}/group" }
#  - { src: 'jenkins/config-agent-passwd.conf.j2', dest: "{{ __docker_stack_appspecs__jenkins_jcac_agent_base_dir }}/passwd" }
#  - { src: 'jenkins/config-agent-group.conf.j2', dest: "{{ __docker_stack_appspecs__jenkins_jcac_swarm_base_dir }}/group" }
#  - { src: 'jenkins/config-agent-passwd.conf.j2', dest: "{{ __docker_stack_appspecs__jenkins_jcac_swarm_base_dir }}/passwd" }

docker_stack_firewalld_appspec_ports__jenkins_jcac:
  - "{{ __docker_stack_appspecs__jenkins_jcac_agent_tcp_port }}/tcp"
  - "{{ __docker_stack_appspecs__jenkins_jcac_agent_ssh_port }}/tcp"


docker_stack_appspec__jenkins_jcac:
  dirs: "{{ docker_stack_appspec_config_dirs__jenkins_jcac | d([]) }}"
  files: "{{ docker_stack_appspec_config_files__jenkins_jcac | d([]) }}"
  templates: "{{ docker_stack_appspec_config_tpls__jenkins_jcac | d([]) }}"
  firewalld_services: "{{ docker_stack_firewalld_appspec_services__jenkins_jcac | d([]) }}"
  firewalld_ports: "{{ docker_stack_firewalld_appspec_ports__jenkins_jcac | d([]) }}"
  networks: "{{ docker_stack_appspec_networks__jenkins_jcac | d({}) }}"
  volumes: "{{ docker_stack_appspec_volumes__jenkins_jcac | d({}) }}"
  docker_services: "{{ docker_stack_appspec_services__jenkins_jcac | d({}) }}"

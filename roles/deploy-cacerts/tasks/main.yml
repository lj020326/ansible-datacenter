---
- include_vars: "{{ ansible_os_family }}.yml"

- name: "Get common CA cert facts"
  include_tasks: get_cert_facts.yml

- name: "Display cert info"
  debug:
    msg:
      - "deploy_cacerts__keystore_cacerts_base_dir={{ deploy_cacerts__keystore_cacerts_base_dir }}"
      - "deploy_cacerts__ca_domain={{ deploy_cacerts__ca_domain }}"
      - "deploy_cacerts__ca_domains_hosted={{ deploy_cacerts__ca_domains_hosted | to_nice_json }}"
      - "deploy_cacerts__ca_service_routes_list={{ deploy_cacerts__ca_service_routes_list | to_nice_json }}"
      - "__deploy_cacerts__ca_intermediate_cert_list={{ __deploy_cacerts__ca_intermediate_cert_list | to_nice_json }}"
      - "__deploy_cacerts__ca_fetch_domains_list={{ __deploy_cacerts__ca_fetch_domains_list | to_nice_json }}"

- name: "Fetch certs from keystore"
  include_tasks: fetch_certs.yml

- name: "Trust certs on node"
  include_tasks: trust_cert.yml

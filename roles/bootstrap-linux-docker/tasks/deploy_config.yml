---
- name: "Docker | Deploy Config | Make sure /etc/docker exists"
  file: path=/etc/docker state=directory

# - name: "Docker | Deploy Config | Deploy /etc/docker/daemon.json"
#   template: src=docker_config.j2 dest=/etc/docker/daemon.json
#   notify: Docker | Restart Docker

#### THESE ALLOW NOT USING TEMPLATE FILE ###
- name: "Docker | Deploy Config | Set the Docker configuration"
  set_fact:
    bootstrap_docker__config: "{{ bootstrap_docker__config|combine({ item.key: item.value }) }}"
  when: item.value | string | length > 0
  with_dict: "{{ bootstrap_docker__options }}"

- name: "Docker | Deploy Config | Deploy /etc/docker/daemon.json"
  copy:
    content: "{{ bootstrap_docker__config | to_nice_json }}\n"
    dest: /etc/docker/daemon.json
  when: bootstrap_docker__config != {}
  notify: Docker | Restart Docker

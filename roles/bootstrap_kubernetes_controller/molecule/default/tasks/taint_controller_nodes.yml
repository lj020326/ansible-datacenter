---

- name: Taint Kubernetes control plane nodes
  kubernetes.core.bootstrap_kubernetes_controller__taint:
    state: present
    name: "{{ bootstrap_kubernetes_controller__controller_node }}"
    taints:
      - effect: NoExecute
        key: "node-role.kubernetes.io/control-plane"
      - effect: NoSchedule
        key: "node-role.kubernetes.io/control-plane"
  loop: "{{ groups['bootstrap_kubernetes_controller__controller'] }}"
  loop_control:
    loop_var: bootstrap_kubernetes_controller__controller_node

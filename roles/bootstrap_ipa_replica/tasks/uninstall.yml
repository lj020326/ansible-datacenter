---
# tasks to uninstall IPA replica

- name: Set parameters
  ansible.builtin.set_fact:
    _ignore_topology_disconnect: "{{ ipaserver_ignore_topology_disconnect | d(ipareplica_ignore_topology_disconnect) | d(omit) }}"
    _ignore_last_of_role: "{{ ipaserver_ignore_last_of_role | d(ipareplica_ignore_last_of_role) | d(omit) }}"
    _remove_from_domain: "{{ ipaserver_remove_from_domain | d(ipareplica_remove_from_domain) | d(omit) }}"
    _remove_on_server: "{{ ipaserver_remove_on_server | d(ipareplica_remove_on_server) | d(omit) }}"

- name: Uninstall - Uninstall replica
  ansible.builtin.include_role:
    name: ipaserver
  vars:
    state: absent
    ipaserver_ignore_topology_disconnect: "{{ _ignore_topology_disconnect | d(false) }}"
    ipaserver_ignore_last_of_role: "{{ _ignore_last_of_role | d(false) }}"
    ipaserver_remove_from_domain: "{{ _remove_from_domain | d(false) }}"
    ipaserver_remove_on_server: "{{ _remove_on_server | d(NULL) }}"

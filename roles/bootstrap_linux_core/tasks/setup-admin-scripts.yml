---
- name: "{{ __bootstrap_linux_core__log_prefix_scripts }} Ensure admin script and admin dirs exist"
  ansible.builtin.file:
    path: "{{ item.path }}"
    state: directory
    owner: "{{ item.owner | d('root') }}"
    group: "{{ item.owner | d('root') }}"
    mode: "{{ item.mode | d(omit) }}"
    recurse: "{{ item.recurse | d(omit) }}"
  loop: "{{ bootstrap_linux_core__admin_script_dirs }}"

## ref: http://www.mydailytutorials.com/ansible-template-module-examples/
- name: "{{ __bootstrap_linux_core__log_prefix_scripts }} Install admin scripts"
  ansible.builtin.copy:
    src: "{{ item.src }}"
    dest: "{{ item.dest }}"
    force: "{{ item.force | d('true') }}"
    ## ref: https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html
    mode: "{{ item.mode | d('0755') }}"
    owner: "{{ item.owner | d('root') }}"
    group: "{{ item.owner | d('root') }}"
    backup: "{{ item.backup | d(omit) }}"
  loop: "{{ bootstrap_linux_core__admin_scripts }}"

## ref: http://www.mydailytutorials.com/ansible-template-module-examples/
- name: "{{ __bootstrap_linux_core__log_prefix_scripts }} Install admin script configs"
  ansible.builtin.template:
    src: "{{ item.src }}"
    dest: "{{ item.dest }}"
    #    force: "{{ item.force | d('true') }}"
    ## ref: https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html
    mode: "{{ item.mode | d('0755') }}"
    owner: "{{ item.owner | d('root') }}"
    group: "{{ item.owner | d('root') }}"
    backup: "{{ item.backup | d(omit) }}"
  loop: "{{ bootstrap_linux_core__admin_script_config_tpls }}"

- name: Display bootstrap_linux_core__admin_cron_list
  ansible.builtin.debug:
    var: bootstrap_linux_core__admin_cron_list

- name: "{{ __bootstrap_linux_core__log_prefix_scripts }} Create backup cron jobs"
  when: bootstrap_linux_core__admin_cron_list | d([])| count>0
  ansible.builtin.cron:
    name: "{{ item.name }}"
    special_time: "{{ item.special_time | d(omit) }}"
    minute: "{{ item.minute | d(omit) }}"
    hour: "{{ item.hour | d(omit) }}"
    job: "{{ item.job }}"
  loop: "{{ bootstrap_linux_core__admin_cron_list }}"

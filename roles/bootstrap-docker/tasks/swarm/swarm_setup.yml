---

- set_fact:
    log_prefix: "Docker | Configure swarm |"

- name: "{{ log_prefix }} Assert required swarm config variables are defined"
  assert:
    that:
      - bootstrap_docker__swarm_leader_host is defined
      - bootstrap_docker__swarm_managers|d([])|length>0
      - bootstrap_docker__swarm_remote_addrs|d([])|length>0

- name: "{{ log_prefix }} LEADER"
  include_tasks: "swarm_leader.yml"
  when: bootstrap_docker__swarm_leader|bool

- name: "{{ log_prefix }} MANAGERS"
  include_tasks: "swarm_manager.yml"
  when: bootstrap_docker__swarm_manager|bool

- name: "{{ log_prefix }} WORKERS"
  include_tasks: "swarm_worker.yml"
  when: bootstrap_docker__swarm_worker|bool

- name: "{{ log_prefix }} Leave swarm"
  include_tasks: "swarm_leave.yml"
  when: bootstrap_docker__swarm_leave|bool
